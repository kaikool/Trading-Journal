@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap'); 
@import './components/goals/goal-styles.css';

/* =====================================================
   GLOBAL REFACTOR NOTES (read once, keep in file)
   - Consolidated duplicate rules (e.g., progress-animate, trade badges, pagination)
   - Normalized spacing to a 4px scale
   - Single source of truth for variables in :root and .dark
   - Safe-area / PWA logic centralized under Utilities
   - Kept class names and behaviors intact for backward compatibility
   ===================================================== */

/* ===== Hard Overrides ===== */
/* Kill all animate-spin globally (requested) */
.animate-spin { animation: none !important; }

/* ===== Scrollbar Utilities ===== */
.scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
.scrollbar-hide::-webkit-scrollbar { display: none; }

/* ===== Transition/Animation Utilities ===== */
.dark * { transition: none !important; }

.progress-animate { transition: width 1s cubic-bezier(0.34, 1.56, 0.64, 1); }

.fade-in { opacity: 1; transition: opacity 0.3s ease-in-out; }
.fade-in.loaded { opacity: 1; }
.fade-in.initially-hidden { opacity: 0; }

/* Image fade helpers */
.trade-image, .trade-form-image { max-width: 100%; opacity: 0; transition: opacity 0.3s ease-in-out; }
.trade-image.loaded, .trade-form-image.loaded { opacity: 1; }

/* =====================================================
   TRADE CARD IMAGE SYSTEM
   ===================================================== */
.trade-card-image-container { position: relative; width: 100%; height: 100%; }
.trade-card-placeholder { position: absolute; inset: 0; display:flex; align-items:center; justify-content:center; transition: opacity 0.3s ease-in-out; }
.trade-card-placeholder-hidden { opacity: 0; }
.trade-card-placeholder-visible { opacity: 1; }
.trade-card-image { position: absolute; inset: 0; transition: opacity 0.3s ease-in-out; opacity: 0; }
.trade-card-image.loaded { opacity: 1; }
.trade-card-zoom-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background-color:rgba(0,0,0,0.3); opacity:0; transition:opacity 0.2s ease-in-out; }
.group:hover .trade-card-zoom-overlay { opacity: 1; }
.trade-card-timeframe-badge { position:absolute; bottom:8px; right:8px; background-color:rgba(0,0,0,0.7); color:#fff; font-size:0.75rem; padding:4px 8px; border-radius:4px; }
.trade-direction-badge { position:absolute; top:8px; left:8px; z-index:5; }
.trade-result-badge { position:absolute; top:8px; right:8px; z-index:5; }

/* =====================================================
   P/L INDICATORS & PIP BADGES
   ===================================================== */
.pnl-indicator { display:flex; align-items:center; gap:0.25rem; }
.pnl-profit { color: hsl(145 80% 35%); }
.dark .pnl-profit { color: hsl(145 75% 55%); }
.pnl-loss { color: hsl(354 90% 45%); }
.dark .pnl-loss { color: hsl(354 85% 65%); }
.pnl-neutral { color: hsl(36 95% 48%); }
.dark .pnl-neutral { color: hsl(36 90% 60%); }

.pip-badge { font-size:0.75rem; padding:0.125rem 0.625rem; border-radius:9999px; }
.pip-badge-profit { background-color: hsla(145,80%,35%,0.12); color:hsl(145 80% 30%); }
.dark .pip-badge-profit { background-color: hsla(145,75%,45%,0.15); color:hsl(145 75% 70%); }
.pip-badge-loss { background-color: hsla(354,90%,45%,0.12); color:hsl(354 90% 35%); }
.dark .pip-badge-loss { background-color: hsla(354,85%,60%,0.15); color:hsl(354,85%,75%); }
.pip-badge-neutral { background-color: hsla(36,95%,48%,0.12); color:hsl(36 95% 35%); }
.dark .pip-badge-neutral { background-color: hsla(36,90%,55%,0.15); color:hsl(36,90%,70%); }

/* =====================================================
   ACTION BUTTONS
   ===================================================== */
.action-button { height:1.75rem; width:1.75rem; padding:0; border-radius:9999px; }
.action-button-icon { height:0.875rem; width:0.875rem; }
.action-button-view { color:hsl(212 92% 45%); }
.action-button-view:hover { background-color:hsla(212,92%,45%,0.12); }
.dark .action-button-view { color:hsl(212 92% 58%); }
.dark .action-button-view:hover { background-color:hsla(212,92%,58%,0.15); }
.action-button-edit { color:hsl(36 95% 48%); }
.action-button-edit:hover { background-color:hsla(36,95%,48%,0.12); }
.dark .action-button-edit { color:hsl(36 90% 55%); }
.dark .action-button-edit:hover { background-color:hsla(36,90%,55%,0.15); }
.action-button-close { color:hsl(145 80% 35%); }
.action-button-close:hover { background-color:hsla(145,80%,35%,0.12); }
.dark .action-button-close { color:hsl(145 75% 55%); }
.dark .action-button-close:hover { background-color:hsla(145,75%,55%,0.15); }
.action-button-delete { color:hsl(354 90% 45%); }
.action-button-delete:hover { background-color:hsla(354,90%,45%,0.12); }
.dark .action-button-delete { color:hsl(354 85% 60%); }
.dark .action-button-delete:hover { background-color:hsla(354,85%,60%,0.15); }

/* =====================================================
   PLACEHOLDERS & SKELETONS
   ===================================================== */
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.5} }
.image-placeholder { width:100%; height:180px; background-color:hsl(var(--muted)/0.3); animation:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite; display:flex; align-items:center; justify-content:center; }
@media (min-width:640px){ .image-placeholder{ height:200px; } }

.activity-placeholder { padding:0.75rem; border-radius:0.5rem; background-color:hsl(var(--muted)/0.3); animation:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite; border:1px solid hsl(var(--border)/0.2); }
.placeholder-circle { width:2rem; height:2rem; border-radius:9999px; background-color:hsl(var(--muted)/0.6); }
.placeholder-text { height:1rem; background-color:hsl(var(--muted)/0.6); border-radius:0.375rem; }
.placeholder-text-sm { height:0.75rem; background-color:hsl(var(--muted)/0.6); border-radius:0.375rem; }

/* Milestones */
.milestone-list { padding:0; max-height:8rem; overflow-y:auto; }

/* =====================================================
   SAFE AREA / PWA UTILITIES (single source of truth)
   ===================================================== */
@layer utilities {
  .no-scrollbar { -ms-overflow-style:none; scrollbar-width:none; }
  .no-scrollbar::-webkit-scrollbar { display:none; }

  .pt-safe{ padding-top:var(--safe-top); }
  .pr-safe{ padding-right:var(--safe-right); }
  .pb-safe{ padding-bottom:var(--spacing-bottom-safe); }
  .pl-safe{ padding-left:var(--safe-left); }
  .px-safe{ padding-left:var(--safe-left); padding-right:var(--safe-right); }
  .py-safe{ padding-top:var(--safe-top); padding-bottom:var(--spacing-bottom-safe); }
  .p-safe{ padding: var(--safe-top) var(--safe-right) var(--spacing-bottom-safe) var(--safe-left); }

  .mt-safe{ margin-top:var(--safe-top); }
  .mr-safe{ margin-right:var(--safe-right); }
  .mb-safe{ margin-bottom:var(--spacing-bottom-safe); }
  .ml-safe{ margin-left:var(--safe-left); }

  .h-screen-safe{ height:100vh; height:calc(100vh - var(--safe-top) - var(--safe-bottom)); height:calc(100dvh - var(--safe-top) - var(--safe-bottom)); }
  .min-h-screen-safe{ min-height:100vh; min-height:calc(100vh - var(--safe-top) - var(--safe-bottom)); min-height:calc(100dvh - var(--safe-top) - var(--safe-bottom)); }

  :root{ --is-pwa:0; --is-mobile:0; --is-mobile-or-pwa:0; }
  @media (display-mode:standalone),(display-mode:fullscreen),(display-mode:minimal-ui){ :root{ --is-pwa:1; --is-mobile-or-pwa:1; } }
  @media (max-width:768px){ :root{ --is-mobile:1; --is-mobile-or-pwa:1; } }
  html[data-pwa-mode="true"]{ --is-pwa:1; }
}

.has-safe-bottom{ padding-bottom:var(--spacing-bottom-safe) !important; }
.has-safe-bottom-margin{ margin-bottom:var(--spacing-bottom-safe) !important; }


.pwa-container{ width:100%; margin:0 auto; padding-left:max(var(--safe-left), var(--min-side-padding)); padding-right:max(var(--safe-right), var(--min-side-padding)); padding-top:var(--safe-top); }
.pwa-top-inset{ padding-top:max(var(--safe-top), 0.5rem); }
.safe-area-splash{ position:fixed; inset:0; width:100vw !important; height:100vh !important; max-width:100vw !important; max-height:100vh !important; margin:0 !important; padding:0 !important; overflow:hidden; z-index:9999; }
.pwa-status-bar-area{padding-top:var(--safe-top);height:calc(var(--status-bar-height) + var(--safe-top));background-color:hsl(var(--background));position:sticky; top:0; z-index:9999;display:flex; align-items:flex-end;}

.pwa-full-bleed{ width:100vw; margin-left:calc(50% - 50vw); margin-right:calc(50% - 50vw); }
@supports (width:100vw){ .pwa-full-bleed{ width:100vw; margin-left:calc(50% - 50vw + var(--safe-left)); margin-right:calc(50% - 50vw + var(--safe-right)); } }

/* Safe-area helpers (env) */
.safe-area-inset{ padding-left:env(safe-area-inset-left,0px); padding-right:env(safe-area-inset-right,0px); padding-bottom:env(safe-area-inset-bottom,0px); padding-top:env(safe-area-inset-top,0px); }
.safe-area-bottom{ padding-bottom:env(safe-area-inset-bottom,0px); }
.safe-area-top{ padding-top:env(safe-area-inset-top,0px); }
.safe-area-left{ padding-left:env(safe-area-inset-left,0px); }
.safe-area-right{ padding-right:env(safe-area-inset-right,0px); }

/* =====================================================
   ACCORDION ENHANCEMENTS
   ===================================================== */
.app-accordion-item{ --item-radius:0.75rem; --item-shadow-normal:0 1px 3px rgba(0,0,0,0.1); --item-shadow-hover:0 4px 12px rgba(0,0,0,0.12); --transition-timing:0.25s cubic-bezier(0.4,0,0.2,1); border-radius:var(--item-radius); transition:all var(--transition-timing); box-shadow:var(--item-shadow-normal); background:var(--background); }
.app-accordion-item[data-state="open"]{ background-color:hsl(var(--card)); border-color:hsl(var(--primary)/0.3); box-shadow:var(--item-shadow-hover); }
.app-accordion-content{ background:hsl(var(--card)/0.7); }
.app-accordion-content-section{ background-color:hsl(var(--background)); border:1px solid hsl(var(--border)/0.3); border-radius:0.5rem; padding:1rem; margin-bottom:1rem; transition:all var(--transition-timing); }
.app-accordion-content-section:hover{ border-color:hsl(var(--border)/0.6); box-shadow:0 2px 8px rgba(0,0,0,0.08); }
.app-accordion-heading{ font-weight:600; margin-bottom:0.5rem; background-image:linear-gradient(to right, hsl(var(--primary)/0.9), hsl(var(--primary)/0.7)); background-clip:text; -webkit-background-clip:text; color:transparent; }

/* =====================================================
   BASE LAYER & THEME TOKENS
   ===================================================== */
@layer base {
  :root{
    /* Safe areas */
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-right: env(safe-area-inset-right, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --safe-left: env(safe-area-inset-left, 0px);

    /* Minimum paddings */
    --min-top-padding: 0.25rem; /* 4px */
    --min-side-padding: 1rem;   /* 16px */

    /* Palette (light) */
    --background: 210 25% 98%;
    --foreground: 212 50% 12%;
    --card: 0 0% 100%;
    --card-foreground: 212 50% 14%;
    --popover: 0 0% 100%;
    --popover-foreground: 212 50% 14%;
    --primary: 212 92% 45%;
    --primary-foreground: 0 0% 100%;
    --secondary: 212 18% 94%;
    --secondary-foreground: 212 55% 20%;
    --muted: 212 25% 96%;
    --muted-foreground: 212 25% 42%;
    --accent: 212 75% 96%;
    --accent-foreground: 212 60% 15%;
    --destructive: 354 90% 45%;
    --destructive-foreground: 0 0% 100%;
    --success: 145 80% 35%;
    --success-foreground: 0 0% 100%;
    --warning: 36 95% 48%;
    --warning-foreground: 0 0% 100%;
    --border: 212 25% 92%;
    --input: 212 25% 92%;
    --ring: 212 92% 45%;
    --info: 212 92% 48%;
    --info-foreground: 0 0% 100%;

    /* Chart colors */
    --chart-1: 212 92% 45%;
    --chart-2: 255 85% 60%;
    --chart-3: 330 85% 55%;
    --chart-4: 36 95% 48%;
    --chart-5: 145 80% 35%;

    /* Typography scale */
    --text-xs: 0.75rem; --text-sm: 0.875rem; --text-base: 1rem; --text-lg: 1.125rem;
    --text-xl: 1.25rem; --text-2xl: 1.5rem; --text-3xl: 1.875rem; --text-4xl: 2.25rem;
    --font-normal:400; --font-medium:500; --font-semibold:600; --font-bold:700;

    /* Icon sizes */
    --icon-xs:0.75rem; --icon-sm:1rem; --icon-md:1.25rem; --icon-lg:1.5rem; --icon-xl:2rem;

    /* 4px grid */
    --spacing-0:0; --spacing-1:0.25rem; --spacing-2:0.5rem; --spacing-3:0.75rem; --spacing-4:1rem; --spacing-5:1.25rem; --spacing-6:1.5rem; --spacing-8:2rem;

    /* Card defaults */
    --card-padding: var(--spacing-4);
    --card-title-size: var(--text-xl);
    --card-icon-size: var(--icon-md);
    --card-title-weight: var(--font-semibold);
    --card-value-size: var(--text-3xl);
    --card-subtitle-size: var(--text-sm);

    /* Sidebar (dark surface) */
    --sidebar-background: 212 40% 12%;
    --sidebar-foreground: 212 30% 98%;
    --sidebar-primary: 212 92% 45%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 212 30% 18%;
    --sidebar-accent-foreground: 212 30% 98%;
    --sidebar-border: 212 30% 16%;
    --sidebar-ring: 212 92% 45%;

    /* Shadows */
    --shadow-sm: 0 1px 3px 0 rgba(0,0,0,0.04), 0 1px 2px 0 rgba(0,0,0,0.02);
    --shadow:    0 2px 8px 0 rgba(0,0,0,0.04), 0 2px 4px 0 rgba(0,0,0,0.03);
    --shadow-md: 0 4px 12px -2px rgba(0,0,0,0.06), 0 2px 6px -1px rgba(0,0,0,0.04);
    --shadow-lg: 0 12px 24px -4px rgba(0,0,0,0.09), 0 8px 16px -8px rgba(0,0,0,0.06);
    --shadow-xl: 0 20px 30px -10px rgba(0,0,0,0.12), 0 10px 20px -10px rgba(0,0,0,0.08);

    --shadow-card: 0 2px 8px rgba(0,0,0,0.04), 0 1px 4px rgba(0,0,0,0.02);
    --shadow-card-hover: 0 4px 12px rgba(0,0,0,0.06), 0 3px 6px rgba(0,0,0,0.04);
    --shadow-button: 0 1px 3px rgba(0,0,0,0.04);
    --shadow-elevated: 0 8px 30px rgba(0,0,0,0.12);
    --shadow-focus: 0 0 0 3px hsla(var(--primary)/0.35);

    --radius: 0.75rem;
  }

  .dark{
    --background: 212 40% 6%;
    --foreground: 210 25% 98%;
    --card: 212 35% 10%;
    --card-foreground: 210 25% 98%;
    --popover: 212 40% 12%;
    --popover-foreground: 210 25% 98%;
    --primary: 212 92% 58%;
    --primary-foreground: 0 0% 100%;
    --secondary: 212 30% 16%;
    --secondary-foreground: 210 25% 98%;
    --muted: 212 30% 14%;
    --muted-foreground: 210 20% 80%;
    --accent: 212 35% 18%;
    --accent-foreground: 210 25% 98%;
    --destructive: 354 90% 65%;
    --destructive-foreground: 0 0% 100%;
    --success: 145 80% 45%;
    --success-foreground: 0 0% 100%;
    --warning: 36 95% 55%;
    --warning-foreground: 0 0% 100%;
    --border: 212 30% 20%;
    --input: 212 30% 20%;
    --ring: 212 92% 58%;
    --info: 212 92% 58%;
    --info-foreground: 0 0% 100%;

    --chart-1: 212 92% 58%;
    --chart-2: 255 85% 65%;
    --chart-3: 330 85% 65%;
    --chart-4: 36 95% 55%;
    --chart-5: 145 80% 45%;

    --shadow-sm: 0 1px 3px 0 rgba(0,0,0,0.3), 0 1px 2px 0 rgba(0,0,0,0.2);
    --shadow:    0 2px 6px 0 rgba(0,0,0,0.3), 0 1px 3px 0 rgba(0,0,0,0.2);
    --shadow-md: 0 4px 12px -1px rgba(0,0,0,0.4), 0 2px 6px -1px rgba(0,0,0,0.3);
    --shadow-lg: 0 8px 16px rgba(0,0,0,0.45), 0 4px 10px rgba(0,0,0,0.35);
    --shadow-xl: 0 16px 24px rgba(0,0,0,0.5), 0 6px 12px rgba(0,0,0,0.4);
    --shadow-card: 0 2px 6px rgba(0,0,0,0.4), 0 1px 3px rgba(0,0,0,0.3);
    --shadow-card-hover: 0 4px 12px rgba(0,0,0,0.5), 0 2px 6px rgba(0,0,0,0.4);
    --shadow-button: 0 1px 3px rgba(0,0,0,0.4);
    --shadow-elevated: 0 8px 18px rgba(0,0,0,0.6);
    --shadow-focus: 0 0 0 3px hsla(var(--primary)/0.45);
  }

  * { @apply border-border; }

  html{ height:100%; margin:0; @apply bg-background antialiased; font-feature-settings:"cv02","cv03","cv04","cv09","cv11"; width:100%; overflow-x:hidden; }
  body{ height:100%; margin:0; @apply text-foreground font-sans; width:100%; max-width:100vw; overflow-x:hidden; -webkit-overflow-scrolling:touch; position:relative; }

  @supports (-webkit-touch-callout:none){ body{ -webkit-text-size-adjust:none; -webkit-font-smoothing:antialiased; } }

  #root{ @apply bg-background; min-height:100vh; min-height:-webkit-fill-available; min-height:100dvh; width:100%; position:relative; overflow-x:hidden; }

  html, body{ min-height:100%; overflow-x:hidden; overflow-y:auto; }

  @supports not (--css: variables){
    @media (max-width:768px), (display-mode:standalone){
      body{ height:100vh; height:100dvh; overflow:hidden; position:fixed; width:100%; top:0; left:0; }
    }
  }
}

/* =====================================================
   CHART DIALOG / IMAGE VIEWER
   ===================================================== */
@media (max-width:640px){
  .chart-disable-zoom-mobile .chart-zoom-controls,
  .chart-disable-zoom-mobile .chart-nav-button,
  [data-zoom-mobile='off'] .chart-zoom-controls,
  [data-zoom-mobile='off'] .chart-nav-button{
    display: none !important;
  }

  .chart-disable-zoom-mobile .chart-image-container,
  .chart-disable-zoom-mobile .chart-image,
  [data-zoom-mobile='off'] .chart-image-container,
  [data-zoom-mobile='off'] .chart-image{
    touch-action: none !important;
    transform: none !important;
    cursor: default !important;
  }
}
html.no-pinch, body.no-pinch{ touch-action: pan-x pan-y; }

:root{
  --chart-dialog-radius: 0.75rem; --chart-dialog-shadow: 0 10px 25px -5px rgba(0,0,0,0.15), 0 8px 10px -6px rgba(0,0,0,0.15); --chart-dialog-bg: hsl(var(--card)); --chart-dialog-z-index: 50; --chart-anim-speed: 300ms; --chart-mobile-breakpoint: 640px; --chart-spacing-xs: var(--spacing-2); --chart-spacing-sm: var(--spacing-3); --chart-spacing-md: var(--spacing-4); --chart-spacing-lg: var(--spacing-6); --chart-title-font-size: var(--text-sm); --chart-title-font-weight: 500; --chart-subtitle-font-size: var(--text-xs); --chart-subtitle-color: hsl(var(--muted-foreground)); --chart-control-size: 2.5rem; --chart-control-icon-size: 1.25rem; --chart-mobile-control-size: 2rem; --chart-mobile-control-icon-size: 1rem; --chart-dot-size: 0.625rem; --chart-dot-spacing: 0.625rem; --chart-image-max-scale: 3; --chart-image-transition: transform 0.2s ease-out;
}
.chart-title{ font-size:var(--chart-title-font-size); font-weight:var(--chart-title-font-weight); }
.chart-subtitle{ font-size:var(--chart-subtitle-font-size); color:hsl(var(--chart-subtitle-color)); }

.chart-content{ background-color:hsl(var(--background)/0.95); position:relative; overflow:hidden; flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:0.375rem; }
.dark .chart-content{ background-color:hsl(var(--background)/0.98); }
@media (max-width:640px){ .chart-content{ padding:0.375rem; } }
@media (max-width:640px),(display-mode:standalone){ .chart-content{ padding-top:0.375rem; padding-right:0.375rem; padding-left:0.375rem; padding-bottom:0.375rem }}

.chart-image-viewport{ width:100%; height:100%; position:relative; overflow:hidden; display:flex; align-items:center; justify-content:center; cursor:grab; }
.chart-image-viewport:active{ cursor:grabbing; }
.chart-image-container{ display:flex; align-items:center; justify-content:center; width:100%; height:100%; transition:opacity var(--chart-anim-speed) ease; position:relative; transform-origin:center; will-change:transform; overflow:hidden; border-radius:0.5rem; }
.chart-image-container.zoomed-in{ cursor:grab; }
.chart-image-container.dragging{ cursor:grabbing; }
.chart-image-container.no-transform{ transform:none; }
.chart-image-container.custom-transform{ /* transform set inline */ }
.chart-image{ max-width:100%; max-height:100%; width:auto; height:auto; object-fit:contain; user-select:none; -webkit-touch-callout:none; -webkit-user-select:none; -webkit-tap-highlight-color:transparent; transform-origin:center; transition:var(--chart-image-transition); border-radius:0.5rem; background-color:transparent; touch-action:auto; }
@media (max-width:640px){ .chart-image{ max-height:calc(100% - 48px); } }
@media (max-width:640px),(display-mode:standalone){ .chart-image{ max-height:calc(100% - var(--safe-bottom) - 0.375rem); } }

.chart-zoom-controls{ position:absolute; right:0.375rem; bottom:calc(0.375rem + var(--safe-bottom)); display:flex; flex-direction:column; gap:0.25rem; z-index:30; }
.chart-zoom-button{ width:var(--chart-control-size); height:var(--chart-control-size); border-radius:50%; background-color:rgba(0,0,0,0.4); color:rgba(255,255,255,0.9); display:flex; align-items:center; justify-content:center; border:none; box-shadow:var(--shadow-sm); backdrop-filter:blur(4px); -webkit-backdrop-filter:blur(4px); }
@media (max-width:640px){ .chart-zoom-button{ width:var(--chart-mobile-control-size); height:var(--chart-mobile-control-size); } }
.chart-zoom-button:hover{ background-color:rgba(0,0,0,0.6); }
.chart-zoom-button:disabled{ opacity:0.4; cursor:not-allowed; background-color:rgba(0,0,0,0.3); }

.chart-pagination{ position:absolute; bottom:max(0.375rem, calc(var(--safe-bottom) + 0.25rem)); left:50%; transform:translateX(-50%); z-index:20; display:flex; justify-content:center; backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px); }
@media (max-width:640px){ .chart-pagination{ bottom:max(0.375rem, calc(var(--safe-bottom) + 0.375rem)); } }
.chart-pagination-dots{ display:flex; align-items:center; gap:0.25rem; padding:0.25rem 0.375rem; background:rgba(0,0,0,0.45); border-radius:9999px; backdrop-filter:blur(4px); -webkit-backdrop-filter:blur(4px); }
.chart-pagination-dot{ width:0.25rem; height:0.25rem; border-radius:9999px; transition:all 0.15s ease; }
.chart-pagination-dot-active{ width:0.375rem; height:0.375rem; background-color:#fff; }
.chart-pagination-dot-inactive{ background-color:rgba(255,255,255,0.35); }

.chart-nav-button{ background-color:rgba(0,0,0,0.4); color:rgba(255,255,255,0.9); transition:background-color 0.2s ease-in-out, transform 0.2s ease-in-out; display:flex; align-items:center; justify-content:center; box-shadow:var(--shadow-sm); position:absolute; top:50%; width:var(--chart-control-size); height:var(--chart-control-size); border-radius:50%; transform:translateY(-50%); z-index:20; }
.chart-nav-button.chart-nav-button-prev{ left:0.375rem; }
.chart-nav-button.chart-nav-button-next{ right:0.375rem; }
@media (min-width:640px){ .chart-nav-button{ display:flex !important; } }
@media (max-width:640px){ .chart-nav-button{ width:var(--chart-mobile-control-size); height:var(--chart-mobile-control-size); } .chart-nav-button.chart-nav-button-prev{ left:0.375rem; } .chart-nav-button.chart-nav-button-next{ right:0.375rem; } }
.chart-nav-button:hover{ background-color:rgba(0,0,0,0.6); transform:translateY(-50%) scale(1.05); }
.chart-nav-button:active{ background-color:rgba(0,0,0,0.7); transform:translateY(-50%) scale(0.95); }

/* =====================================================
   STAT CARD SYSTEM
   ===================================================== */
.stat-card{ --stat-card-padding:1rem; --stat-card-radius:var(--radius); --stat-card-border-opacity:0.3; --stat-card-shadow:var(--shadow-sm); --stat-card-hover-shadow:var(--shadow-md); --stat-card-anim-speed:200ms; --stat-card-z-index:10; --stat-value-font-size:1.75rem; --stat-value-font-weight:600; --stat-title-font-size:0.875rem; --stat-title-font-weight:500; --stat-suffix-font-size:1.125rem; --stat-icon-size:1.25rem; --stat-icon-container-size:2rem; --stat-icon-container-padding:0.375rem; --stat-icon-container-radius:9999px; --stat-progress-height:0.25rem; --stat-progress-radius:9999px; padding:var(--stat-card-padding); border-radius:var(--stat-card-radius); box-shadow:var(--stat-card-shadow); border:1px solid hsl(var(--border)/var(--stat-card-border-opacity)); overflow:hidden; position:relative; transition:all var(--stat-card-anim-speed) ease-in-out; }
.stat-card-compact{ --stat-card-padding:0.75rem; --stat-value-font-size:1.5rem; padding:var(--stat-card-padding); }
.stat-card:hover{ box-shadow:var(--stat-card-hover-shadow); }
.stat-card-bg{ position:absolute; inset:0; opacity:0.6; transition:all var(--stat-card-anim-speed) cubic-bezier(0.4,0,0.2,1); background-blend-mode:soft-light; backdrop-filter:blur(8px) saturate(1.1); mix-blend-mode:normal; }
.stat-card:hover .stat-card-bg{ opacity:0.8; backdrop-filter:blur(12px) saturate(1.2); }
.stat-card-header{ display:flex; justify-content:space-between; margin-bottom:0.75rem; position:relative; z-index:var(--stat-card-z-index); }
.stat-card-title{ font-size:var(--stat-title-font-size); font-weight:var(--stat-title-font-weight); color:hsl(var(--muted-foreground)); }
.stat-card-icon-container{ display:flex; align-items:center; justify-content:center; padding:var(--stat-icon-container-padding); border-radius:var(--stat-icon-container-radius); }
.stat-card-value{ font-size:var(--stat-value-font-size); font-weight:var(--stat-value-font-weight); margin-bottom:0.5rem; position:relative; z-index:var(--stat-card-z-index); letter-spacing:-0.025em; }
.stat-card-suffix{ font-size:var(--stat-suffix-font-size); margin-left:0.25rem; opacity:0.8; }
.stat-card-progress-container{ width:100%; background-color:hsl(var(--muted)/0.4); border-radius:var(--stat-progress-radius); height:var(--stat-progress-height); margin-top:0.5rem; position:relative; z-index:var(--stat-card-z-index); }
.stat-card-progress{ height:100%; border-radius:var(--stat-progress-radius); }
.stat-card-supporting-text{ display:flex; align-items:center; position:relative; z-index:var(--stat-card-z-index); margin-top:0.5rem; }
.stat-card-skeleton{ padding:var(--stat-card-padding); border-radius:var(--stat-card-radius); box-shadow:var(--stat-card-shadow); height:138px; border:1px solid hsl(var(--border)/var(--stat-card-border-opacity)); animation:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite; }

/* =====================================================
   MODERN CARD EXTRAS
   ===================================================== */
.gradient-card{ position:relative; }
.bg-radial{ background: radial-gradient(circle at top right, var(--gradient-from), var(--gradient-to)); }
.card-gradient-primary{ --gradient-from: hsl(var(--primary)/0.12); --gradient-to: hsl(var(--primary)/0.02); }
.card-gradient-success{ --gradient-from: hsl(var(--success)/0.12); --gradient-to: hsl(var(--success)/0.02); }
.card-gradient-warning{ --gradient-from: hsl(var(--warning)/0.12); --gradient-to: hsl(var(--warning)/0.02); }
.card-gradient-destructive{ --gradient-from: hsl(var(--destructive)/0.12); --gradient-to: hsl(var(--destructive)/0.02); }
.card-gradient-muted{ --gradient-from: hsl(var(--muted)/0.15); --gradient-to: hsl(var(--muted)/0.03); }
.dark .card-gradient-primary{ --gradient-from: hsl(var(--primary)/0.18); --gradient-to: hsl(var(--primary)/0.03); }
.dark .card-gradient-success{ --gradient-from: hsl(var(--success)/0.18); --gradient-to: hsl(var(--success)/0.03); }
.dark .card-gradient-warning{ --gradient-from: hsl(var(--warning)/0.18); --gradient-to: hsl(var(--warning)/0.03); }
.dark .card-gradient-destructive{ --gradient-from: hsl(var(--destructive)/0.18); --gradient-to: hsl(var(--destructive)/0.03); }
.dark .card-gradient-muted{ --gradient-from: hsl(var(--muted)/0.20); --gradient-to: hsl(var(--muted)/0.04); }
.card-value{ font-size:var(--card-value-size,1.75rem); font-weight:var(--card-value-weight,600); line-height:1.2; letter-spacing:-0.01em; }
.card-label{ font-size:var(--card-label-size,0.875rem); font-weight:var(--card-label-weight,500); color:hsl(var(--muted-foreground)); }
.card-spotlight{ position:relative; overflow:hidden; }
.card-spotlight::before{ content:''; position:absolute; inset:0; background: radial-gradient(circle at var(--x,50%) var(--y,50%), hsl(var(--primary)/0.12) 0%, transparent 25%); opacity:0; transition:opacity 0.4s ease; z-index:0; pointer-events:none; }
.card-spotlight:hover::before{ opacity:1; }

/* =====================================================
   LAYOUT / CONTAINERS
   ===================================================== */
.container, form, .grid, .space-y-6, .space-y-8, [class*="grid-cols-"], [class*="gap-"]{ max-width:100%; overflow-x:hidden; }
.app-content-container{ flex:1; position:relative; max-width:1200px; width:100%; margin-left:auto; margin-right:auto; padding-left:1rem; padding-right:1rem; }
.app-layout-container{ display:flex; flex-direction:column; min-height:100dvh; overflow:visible; max-width:100%; padding-top:var(--safe-top); padding-left:var(--safe-left); padding-right:var(--safe-right); background-color:hsl(var(--background)); }
@media (min-width:769px){ .app-layout-container{ min-height:100vh; overflow:visible; } }

/* Chart legend */
.chart-legend{ padding-top:8px; font-size:12px; width:100%; display:flex; flex-wrap:wrap; justify-content:center; row-gap:4px; }

/* Card title fix */
h3.card-title{ line-height:1.5 !important; padding:0.125rem 0 !important; height:auto !important; display:flex !important; align-items:center !important; text-rendering:optimizeLegibility; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

/* Muted foreground standardization */
.text-muted-foreground{ @apply text-foreground/70; }

/* =====================================================
   SCROLLBARS, GLASS, MISC
   ===================================================== */
::-webkit-scrollbar{ width:8px; height:8px; }
::-webkit-scrollbar-track{ background:hsl(var(--muted)); border-radius:8px; }
::-webkit-scrollbar-thumb{ background:hsl(var(--muted-foreground)/0.5); border-radius:8px; }
::-webkit-scrollbar-thumb:hover{ background:hsl(var(--muted-foreground)/0.7); }

.glass{ backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px); }

/* =====================================================
   BALANCE / PERFORMANCE CHART
   ===================================================== */
.balance-chart{ --balance-chart-height:220px; --balance-chart-radius:var(--radius); --balance-chart-border-opacity:0.3; --balance-chart-shadow:var(--shadow-sm); --balance-chart-hover-shadow:var(--shadow-md); --balance-chart-title-size:1.25rem; --balance-chart-label-size:0.75rem; --balance-chart-value-size:1rem; --balance-chart-padding:1rem; --balance-chart-margin:0.5rem; --balance-chart-point-size:4px; --balance-chart-line-width:2px; --balance-chart-gradient-opacity-top:0.2; --balance-chart-gradient-opacity-bottom:0; --balance-chart-tooltip-shadow:var(--shadow-md); --balance-chart-tooltip-border-radius:0.5rem; --balance-chart-tooltip-padding:0.75rem; --balance-chart-anim-speed:1000ms; --balance-chart-mobile-breakpoint:640px; --balance-chart-tablet-breakpoint:768px; --balance-chart-desktop-breakpoint:1024px; border-radius:var(--balance-chart-radius); transition: box-shadow 0.2s ease-in-out; }
.balance-chart-container{ height:var(--balance-chart-height); width:100%; position:relative; min-height:200px; }
.balance-chart-badge{ display:flex; align-items:center; padding:0 0.75rem; height:1.5rem; border-radius:9999px; font-size:var(--balance-chart-label-size); font-weight:500; }
.balance-chart-value{ font-weight:600; font-size:var(--balance-chart-value-size); }
.balance-chart-tooltip{ background-color:hsl(var(--card)); border:1px solid hsl(var(--border)); box-shadow:var(--balance-chart-tooltip-shadow); border-radius:var(--balance-chart-tooltip-border-radius); padding:var(--balance-chart-tooltip-padding); font-size:0.875rem; }
.balance-chart-tooltip-date{ font-weight:500; margin-bottom:0.25rem; }
.balance-chart-tooltip-value{ font-weight:700; }
.balance-chart-empty{ display:flex; flex-direction:column; align-items:center; justify-content:center; height:var(--balance-chart-height); text-align:center; padding:var(--balance-chart-padding); }
.balance-chart-empty-icon{ color:hsl(var(--muted-foreground)/0.3); width:2rem; height:2rem; margin-bottom:0.5rem; }
.balance-chart-empty-title{ font-weight:500; color:hsl(var(--muted-foreground)); margin-bottom:0.25rem; }
.balance-chart-empty-subtitle{ font-size:0.875rem; color:hsl(var(--muted-foreground)/0.7); }
.balance-card-gradient{ background: linear-gradient(145deg, hsl(213 92% 45%), hsl(222 47% 30%)); }
.profit-gradient{ background: linear-gradient(145deg, hsl(142 72% 45% / 0.1), hsl(142 72% 45% / 0.05)); }
.loss-gradient{ background: linear-gradient(145deg, hsl(0 84% 60% / 0.1), hsl(0 84% 60% / 0.05)); }
.chart-tooltip-text-color-1{ color:hsl(var(--chart-1)); }
.chart-tooltip-text-color-2{ color:hsl(var(--chart-2)); }
.chart-tooltip-text-color-3{ color:hsl(var(--chart-3)); }
.chart-tooltip-text-color-4{ color:hsl(var(--chart-4)); }
.chart-tooltip-text-color-5{ color:hsl(var(--chart-5)); }

/* Progress keyframes (used by StatCard) */
@keyframes progress{ 0%{ width:0; } 100%{ width:var(--progress-width,0%); } }

/* =====================================================
   FORMS / INPUTS / TEXT
   ===================================================== */
.custom-input{ transition:all 0.2s ease-in-out; }
.custom-select{ appearance:none; background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position:right 0.5rem center; background-repeat:no-repeat; background-size:1.5em 1.5em; }

.profit-text{ color:hsl(var(--success)); }
.loss-text{ color:hsl(var(--destructive)); }

.discipline-indicator{ height:0.5rem; width:0.5rem; border-radius:9999px; margin-right:0.375rem; }
.discipline-indicator-yes{ background-color:hsl(var(--success)); }
.discipline-indicator-no{ background-color:hsl(var(--destructive)); }

.interactive-hover, .interactive-element{ transition:all 0.2s ease-in-out; }
.interactive-hover:hover, .interactive-element:hover{ transform:translateY(-1px); box-shadow:var(--shadow-md); filter:brightness(1.05); }
.interactive-hover:active, .interactive-element:active{ transform:translateY(0); filter:brightness(0.95); }

/* ===== StatusBar shim + collapse-on-scroll ===== */

/* ========== SAFE TOP: chỉ pad 1 lần, và thu gọn khi cuộn ========== */
.safe-top-pad {
  padding-top: env(safe-area-inset-top, 0px);
  transition: padding-top 220ms ease;
  will-change: padding-top;
}
/* Khi đã cuộn, bỏ pad-top để content tràn lên notch */
.safe-top-collapsed .safe-top-pad { padding-top: 0; }

/* ===== SAFE BOTTOM: mặc định KHÔNG pad ===== */
.safe-bottom-pad {
  transition: padding-bottom 220ms ease;
  will-change: padding-bottom;
}
/* Khi THẬT SỰ cần tôn trọng safe-area (ví dụ có bottom-nav/cta) thì thêm class vào <html> */
.safe-bottom-expanded .safe-bottom-pad {
  padding-bottom: env(safe-area-inset-bottom, 0px) !important;
}

/* Nền đồng nhất để không lộ viền */
html, body, #root { background-color: hsl(var(--background)); }

/* ************ FIX cấu trúc DOM (AppLayout là PARENT) ************ */
/* AppLayout không tự pad safe area nữa – để wrapper safe-*-pad kiểm soát */
.app-layout-container { 
  padding-top: 0 !important;
}
/* Nếu header cũ từng pad theo safe-area, triệt tiêu luôn */
.mobile-header { 
  padding-top: 0 !important;
}

/* =====================================================
   MINOR FIXES / MISC MERGES
   ===================================================== */
.milestone-list{ /* already defined above; kept here to ensure specificity if imported later */ }
/* End of file */